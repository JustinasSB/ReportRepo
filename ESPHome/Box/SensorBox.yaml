esphome:
  name: sensorbox
  friendly_name: SensorBox
  includes:
    - scd4x_sensor.h
    - custom_rf_receiver/custom_rf_receiver.h
  libraries:
    - Wire
    - Improv=https://github.com/sparkfun/SparkFun_SCD4x_Arduino_Library.git#v1.1.2
esp32:
  board: esp32dev
  framework:
    type: arduino

logger:

api:

ota:

i2c:
  - sda: GPIO19
    scl: GPIO18
    id: bus_a
    scan: true
  - sda: GPIO23
    scl: GPIO21
    id: disp
    scan: True
  - sda: 0
    scl: 4
    id: ambientlight
    scan: True

custom_component:
  - lambda: |-
      auto rf_receiver = new CustomRFReceiver(15, false, 10);
      return {rf_receiver};

wifi:

sensor:
  - platform: bh1750
    i2c_id: ambientlight
    name: "Ambient Light"
    address: 0x23
    update_interval: 5s

  - platform: custom
    lambda: |-
      auto my_sensor = new SCD4xSensor();
      App.register_component(my_sensor);
      return {
        my_sensor->get_co2_sensor(),
        my_sensor->get_temperature_sensor(),
        my_sensor->get_humidity_sensor()
      };
    sensors:
      - name: "CO2 Concentration"
        unit_of_measurement: "ppm"
        id: co2
      - name: "Temperature"
        unit_of_measurement: "°C"
        accuracy_decimals: 1
        id: temp
      - name: "Humidity"
        unit_of_measurement: "%"
        accuracy_decimals: 1
        id: humid

interval:
  - interval: 5s 
    then:
      - lvgl.label.update:
          id: carbon
          text:
            format: "CO2: %.0f ppm"
            args: [id(co2).state]
      - lvgl.label.update:
          id: temperature
          text:
            format: "Temp: %.1f °C"
            args: [id(temp).state]
      - lvgl.label.update:
          id: humidity
          text:
            format: "Humid: %.1f %%"
            args: [id(humid).state]

lvgl:
  bg_color: 0x000000
  default_font: montserrat_16
  widgets:
    - label:
        id: carbon
        x: 0
        y: 0 
    - label:
        id: temperature
        x: 0
        y: 20 
    - label:
        id: humidity
        x: 0
        y: 40 

display:
  - platform: ssd1306_i2c
    i2c_id: disp
    model: SSD1306_128X64
    address: 0x3C
    auto_clear_enabled: False

remote_transmitter:
  pin: GPIO22
  carrier_duty_percent: 100

switch:
  - platform: gpio
    pin: 2
    name: "Toggle automation off (1 Hr)"
    id: "Guest_room_automation_toggle"
    restore_mode: ALWAYS_OFF
    on_turn_on: 
      then:
        - script.execute: off_script
    on_turn_off: 
      then:
        - script.stop: off_script

  - platform: gpio
    pin: 16
    id: rf_cs_pin
    restore_mode: ALWAYS_OFF
        

script:
  - id: off_script
    mode: restart
    then: 
      - delay: 1h
      - switch.turn_off: Guest_room_automation_toggle

button:
  - platform: template
    name: "Transmit UP"
    on_press:
      - remote_transmitter.transmit_raw: 
          code: [220, -5330, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -7852, 4855, -1495, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -7852, 4855, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -7852, 4855, -1498, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -7852, 4855, -1495, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -7852, 4855, -1496, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -7852, 4855, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -8205, 4855, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -8205, 4855, -1498, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -8205, 4855, -1498, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -8205, 4855, -1498, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -8205, 4855, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367]
  - platform: template
    name: "Transmit DOWN"
    on_press:
      - remote_transmitter.transmit_raw: 
          code: [227, -5330, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -7860, 4860, -1494, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -7860, 4860, -1498, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -7860, 4860, -1499, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -7860, 4860, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -7860, 4860, -1498, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -7860, 4860, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 367, -8213, 4860, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 367, -8213, 4860, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 367, -8213, 4860, -1496, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 367, -8213, 4860, -1497, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 367, -8213, 4860, -1496, 720, -367, 367, -720, 367, -720, 720, -367, 367, -720, 720, -367, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 367, -720, 720, -367, 367, -720, 367, -720, 720, -367, 720, -367, 720, -367, 720, -367, 367, -720, 367]


captive_portal:
    
